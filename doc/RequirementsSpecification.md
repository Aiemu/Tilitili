# 每日清华规格需求说明书

小组成员 李胜涛 郑炜熹 曾正

## 系统角色
该系统一共有种角色，总管理员、版主、板块管理员、普通用户（教工、学生），不同的角色其权限不同。
### 总管理员
总管理员拥有**该系统**的**最高权限**，可对所有其他用户、软件中的所有内容进行增删改等操作，所有操作均在Web端的管理页面进行操作，具体包含以下操作
1. 赋予特定用户版主或板块管理员的权限
    通过后台直接赋予（审核）特定用户版主或板块管理员的权限。
2. 直接对各板块内容进行操作
    总管理员可直接对各板块的所有内容进行增删改操作。
### 版主
版主拥有**某一板块**的**最高权限**，该权限由总管理赋予，并由总管理员进行后期管理维护，可对板块内用户和内容进行增删改操作，具体包括以下权限:
1. 赋予（剥夺）特定用户该板块板块管理员的权限
    版主可在该系统中添加（删除）自己管理板块的板块管理员，并赋予（剥夺）其除本条权限外版主的所有权限。
2. 审核非板块内用户加入该板块的申请
    所有用户均可申请成为某一板块的板块内用户，拥有查看仅该板块成员可查看内容的权限。版主负责审核用户成为板块内成员的申请。
3. 取消特定用户在该板的块板块内用户身份
    版主可取消某一用户在该板块的板块内用户的身份。
4. 审核用户投稿到该板块的内容
    板块内用户可通过投稿的方式添加内容到该板块，版主负责投稿的审核工作。
5. 对板块内所有内容进行增删改操作
    版主可直接对该板块所有内容进行增删改操作。
### 板块管理员
板块管理员拥有版主除赋予（剥夺）特定用户该板块板块管理员权限外的所有权限，具体权限此处不再赘述。
### 普通用户
普通用户在通过**校园身份验证**后即可查看所有公开内容及自己所属板块的非公开内容。
1. 普通用户校园身份验证
    普通用户需要通过确认发往校园邮箱的确认邮件完成校园身份认证。
2. 普通用户可申请成为任意板块的板块内用户
    普通用户申请成为某一板块板块内成员，在经版主或板块管理员审核后即拥有该身份，可查看该板块的所有非公开内容。
3. 用户可接受来自板块的推送消息
    用户可接受来自各板块的所有公开推送及其所属板块的非公开推送消息。
4. 用户可修改其个人信息
    用户可自定义其昵称、头像、签名等个人信息。
5. 用户可点赞、评论、转发内容
    用户可对其可查看内容进行点赞、评论、转发。
6. 用户间可以进行聊天
    用户间可以进行文字、图片聊天并可转发分享内容，若接受转发的用户非该板块板块内用户则无法查看转发的具体内容。
7. 用户可查看板块中的内容
    用户可查看各板块的所有公开内容及其所属板块的非公开内容，其中视频、音频支持手动变速播放。
8. 用户搜索其他用户并将其添加为好友
    用户可通过学号、昵称等搜索到另一用户并添加其为好友。
9. 用户可查看历史记录、使用时长
    用户可查看、管理自己的历史记录，并可查看文章、视频、图片的浏览时长。

## 功能清单
1. 对所有推送消息、内容进行归档
    内容的发布者可添加内容的标签，方便用户归类、查看。
2. 将内容添加到*稍后再看*
    用户可将内容添加到稍后再看以避免遗漏查看消息。
3. 收藏内容
    用户可将内容添加到自己不同的收藏夹，进行归类，方便日后查看。
系统角色中所述的全部用户功能，此处不再赘述

## 界面设计
基于该APP的角色定位以及功能特点, 界面会分为以下几个大模块:

### 用户信息界面
该界面为用户的个人界面, 每名用户(版主, 板块管理员, 普通用户)在登陆后都会有属于自己的个人界面. 该界面有:
- 用户的基础个人信息. 如姓名, 院系, 社团等, 这些信息会直接显示在个人界面上.
- 用户的浏览历史记录. 该用户最近的浏览记录将会被保存, 并通过界面的按钮跳转到历史记录界面.
- 用户的通知. 从系统管理员收到的通知, 从板块推送来的消息等将会被保存, 并通过界面的按钮跳转到通知页面.
- 用户的好友. 用户可以通过按钮跳转到好友界面, 该界面可以进行好友的搜索, 添加等操作. 已经添加的好友可以在该界面选定之后跳入新的窗口进行聊天.
- 用户的权限操作. 用户可以通过按钮跳转到权限操作界面, 该界面会显示用户当前的板块权限(版主, 板块管理员, 普通用户). 同时其他用户投稿到该用户所管的板块内容, 用户加入板块的申请等权限操作会在这里被审核.
- 用户的个人空间. 用户通过按钮跳转到个人空间界面, 该界面会显示用户投稿的内容, 收藏的内容等信息.
- 用户的账号管理. 通过按钮跳转到管理界面, 该界面实现用户的身份认证, 密码修改等账号管理问题.

### 校园信息界面
该界面为应用的主界面. 信息界面会根据类型不同(校园, 社团, 院系)被分成几个板块. 以其中某个板块为例, 该板块会有:

#### 主界面

- 主界面会显示最新的在该板块投稿的内容(视频, 文章等), 点击这些内容会进入详细内容界面.
- 主界面会有投稿按钮, 按下该按钮可以进入投稿界面.
- 主界面的内容可以根据热度或者时间排序.

#### 详细内容界面

在从主界面点击某个投稿内容后将会跳进详细内容界面.

- 该界面会显示投稿的内容(视频, 文章等).
- 该界面会显示所有在内容下的评论和回复.
- 该界面会显示视频的信息(标题, 时间, 点赞数, 回复数等)
- 该界面提供分享按钮, 将该内容分享给其他用户(可以选择软件内或者软件外)

#### 投稿界面

- 该界面提供视频投稿或者文章投稿两种形式, 用户可以选择两种形式中的一种进行投稿.
- 投稿视频, 用户可以选择本地的一个视频上传.
- 投稿文章, 用户可以在该app在线编辑.
- 按下投稿按钮后, 内容将会被送去管理员进行审核, 审核后的内容将会显示在主界面上.

## 性能需求
对于项目的性能我们目前尚无法给出完整的要求，因为作为一款校内消息通知和多平台信息整合得到app，对于性能的总体需求并不是很高。但是其中的几部分仍需要注意：
1.	视频播放：在现在视频播放画质和帧率越来越高的时候，播放视频需要的性能也在不断提高，但是对于一个信息投放平台来说，高画质高帧率的视频并不是必须，所以我们将对投放的视频格式加以限制并且会对部分视频可能进行压制。
2.	使用缓存：本app将在本地使用缓存策略，由于大部分收到的历史消息并不会进行修改或者变动，所以在大多数我们将使用本地的缓存展示，只有在部分特殊情况下对消息进行重新加载如学生所关注的社团等发生变化或者投稿方修改稿件等。

## 安全性控制
1. 权限管理
   按照系统角色我们设置多级权限，详情可以参看上述系统角色描述。
2. 数据存储
   按照不同的类型将用户数据分别采用不同方式进行本地存储，如用户名、登录信息等采用加密方式存储本地，而其他一些信息如部分已加载的消息、历史记录可以简单的存储避免多次加密解密影响性能和流畅程度。
3. 登录管理
   可以通过ip获取用户经常登录的地区，当用户在非常用IP登录时可以通过邮件或通知的方式告诉用户，提醒其注意信息安全。

## 数据备份和恢复
1. 备份
   这里我们可以在服务器方面做定时备份，对于数据库中的数据可以采取使用脚本每隔一定时间进行备份数据的策略；而用户方面如果出现异常可以先查看本地的缓存数据，待服务器正常后再次请求最新数据。
2. 恢复
   当服务器数据库出现异常时，服务器可以根据已经备份的数据进行恢复。

## 日志系统
日志系统应该分为两部分，一部分在客户端，记录客户端的状态变化，如在启动哪一个activity时发生了崩溃等。可以选择让用户在崩溃时发送日志，这样便于查找问题。另一部分应在服务端，记录下服务器的状态变化以便在服务器发生崩溃时快速查找问题。
